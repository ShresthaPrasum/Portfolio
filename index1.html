<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Whiz üß†</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&family=Bubblegum+Sans&display=swap');

        :root {
            --color-bg-1: #4a00e0;
            --color-bg-2: #8e2de2;
            --color-primary: #ffc300;
            --color-secondary: #00c6ff;
            --color-text: #ffffff;
            --color-correct: #4CAF50;
            --color-wrong: #f44336;
            --color-team-a: #ff5733;
            --color-team-b: #338dff;
            --color-team-c: #33ff57;
            --color-container-bg: rgba(0, 0, 0, 0.3);
            --color-modal-overlay: rgba(0, 0, 0, 0.75);
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, var(--color-bg-1), var(--color-bg-2));
            background-size: 200% 200%;
            animation: gradient-animation 15s ease infinite;
            color: var(--color-text);
            margin: 0;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            text-align: center;
            overflow-x: hidden;
            box-sizing: border-box;
        }

        @keyframes gradient-animation {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .hidden {
            display: none !important;
        }

        .section {
            width: 100%;
            max-width: 1000px;
        }

        .container {
            background: var(--color-container-bg);
            border-radius: 25px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.1);
            transition: all 0.5s ease-in-out;
        }

        h1, h2 {
            font-family: 'Bubblegum Sans', cursive;
            text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.5);
            margin: 0;
        }
        h1 { font-size: clamp(2.5rem, 8vw, 4.5rem); color: var(--color-primary); }
        h2 { font-size: clamp(2rem, 6vw, 2.8rem); color: var(--color-secondary); }
        p { font-size: clamp(1rem, 3vw, 1.2rem); line-height: 1.6; }

        .btn {
            font-family: 'Poppins', sans-serif;
            font-weight: 700;
            font-size: clamp(1rem, 4vw, 1.2rem);
            padding: 15px 30px;
            border-radius: 50px;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            color: var(--color-text);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            text-transform: uppercase;
            letter-spacing: 1px;
            background-color: var(--color-secondary);
            color: #000;
        }
        .btn:hover:not(:disabled) {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4);
        }
        .btn:disabled {
            background-color: #777;
            cursor: not-allowed;
            opacity: 0.6;
        }

        /* --- Game Board --- */
        #game-board .team-selection {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 25px 0;
            flex-wrap: wrap;
        }
        .team-btn.active {
            box-shadow: 0 0 20px var(--color-primary);
            transform: scale(1.1);
        }
        #team-a-btn { background-color: var(--color-team-a); }
        #team-b-btn { background-color: var(--color-team-b); }
        #team-c-btn { background-color: var(--color-team-c); }

        .score-board {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        .score {
            padding: 10px 20px;
            border-radius: 10px;
            font-size: clamp(1rem, 4vw, 1.2rem);
            font-weight: 700;
            transition: all 0.3s ease;
        }
        .score.highlight-turn {
            transform: scale(1.15);
            box-shadow: 0 0 15px currentColor;
        }
        #score-a { background-color: var(--color-team-a); color: white; }
        #score-b { background-color: var(--color-team-b); color: white; }
        #score-c { background-color: var(--color-team-c); color: white; }

        #game-status-text {
            font-size: clamp(1.2rem, 4vw, 1.5rem);
            color: var(--color-primary);
            min-height: 50px;
            font-weight: 700;
        }

        /* --- Question Picker --- */
        #question-picker {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(60px, 1fr));
            gap: 10px;
            margin-top: 20px;
            transition: opacity 0.3s ease;
        }
        .question-box {
            background-color: rgba(255, 255, 255, 0.1);
            border: 2px solid var(--color-secondary);
            aspect-ratio: 1 / 1;
            display: flex; justify-content: center; align-items: center;
            border-radius: 10px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s ease;
            user-select: none;
        }
        .question-box:hover:not(.used) {
            background-color: var(--color-secondary);
            color: #000;
            transform: scale(1.1);
        }
        .question-box.used {
            background-color: rgba(0, 0, 0, 0.4);
            border-color: #555;
            color: #888;
            cursor: not-allowed;
            text-decoration: line-through;
        }
        #question-picker.disabled .question-box:not(.used) {
            opacity: 0.5;
            pointer-events: none;
        }

        /* --- Question Area --- */
        #question-area {
            margin-top: 20px;
            padding: 25px;
            background: rgba(0,0,0,0.2);
            border-radius: 15px;
            min-height: 250px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        #timer {
            font-family: 'Bubblegum Sans', cursive;
            font-size: 3.5rem;
            color: var(--color-primary);
            margin-bottom: 15px;
            transition: color 0.3s ease;
        }
        #timer.low-time {
            color: var(--color-wrong);
            animation: pulse 1s infinite;
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        #question-text {
            font-size: clamp(1.3rem, 4vw, 1.8rem);
            font-weight: 700;
            line-height: 1.5;
        }
        
        .answer-actions {
            display: flex;
            gap: 20px;
            margin-top: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }
        #correct-btn { background-color: var(--color-correct); }
        #wrong-btn { background-color: var(--color-wrong); }
        
        /* --- Answer Modal --- */
        .modal-overlay {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: var(--color-modal-overlay);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }
        .modal-overlay.visible {
            opacity: 1;
            visibility: visible;
        }
        .modal-content {
            background: linear-gradient(135deg, var(--color-bg-1), var(--color-bg-2));
            border-radius: 20px;
            padding: 40px;
            max-width: 90%;
            width: 600px;
            box-shadow: 0 0 50px rgba(0,0,0,0.5);
            border: 3px solid var(--color-primary);
            transform: scale(0.7);
            transition: transform 0.4s cubic-bezier(0.18, 0.89, 0.32, 1.28);
        }
        .modal-overlay.visible .modal-content {
            transform: scale(1);
        }
        #answer-text {
            font-size: clamp(1.5rem, 5vw, 2.2rem);
            color: var(--color-primary);
            font-weight: 700;
            line-height: 1.4;
        }

        /* --- End Screen --- */
        #final-scores {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin: 30px 0;
            align-items: center;
        }
        .final-score {
            font-size: clamp(1.2rem, 5vw, 1.8rem);
            padding: 15px 25px;
            border-radius: 10px;
            font-weight: 700;
            width: 80%;
            max-width: 300px;
        }
    </style>
</head>
<body>

    <div id="welcome-screen" class="section">
        <div class="container">
            <h1>Quiz Whiz</h1>
            <p>Ready to test your knowledge? Press start to begin the ultimate quiz challenge!</p>
            <button id="start-game-btn" class="btn">Start Game</button>
        </div>
    </div>

    <div id="game-board" class="section hidden">
        <div class="container">
            <div id="team-selection-area">
                <h2>First, Pick Your Teams!</h2>
                <div class="team-selection">
                    <button id="team-a-btn" class="btn team-btn" data-team="A">Team A</button>
                    <button id="team-b-btn" class="btn team-btn" data-team="B">Team B</button>
                    <button id="team-c-btn" class="btn team-btn" data-team="C">Team C</button>
                </div>
            </div>

            <div class="score-board">
                <div id="score-a" class="score">Team A: <span id="score-val-a">0</span></div>
                <div id="score-b" class="score">Team B: <span id="score-val-b">0</span></div>
                <div id="score-c" class="score">Team C: <span id="score-val-c">0</span></div>
            </div>
            
            <h3 id="game-status-text">Select a team to start playing.</h3>

            <div id="question-picker" class="disabled">
                </div>
            
            <div id="question-area" class="hidden">
                <div id="timer">30</div>
                <p id="question-text"></p>
                <div id="start-timer-wrapper">
                    <button id="start-timer-btn" class="btn">Start Timer & Reveal Question</button>
                </div>
                <div id="answer-actions-wrapper" class="answer-actions hidden">
                    <button id="correct-btn" class="btn">‚úÖ Correct</button>
                    <button id="wrong-btn" class="btn">‚ùå Wrong</button>
                </div>
            </div>
        </div>
    </div>
    
    <div id="answer-modal" class="modal-overlay">
        <div class="modal-content">
            <h2>The Answer Is...</h2>
            <p id="answer-text"></p>
        </div>
    </div>

    <div id="end-screen" class="section hidden">
        <div class="container">
            <h1 id="winner-text"></h1>
            <h2>Final Scores:</h2>
            <div id="final-scores">
                <div id="final-score-a" class="final-score">Team A: 0</div>
                <div id="final-score-b" class="final-score">Team B: 0</div>
                <div id="final-score-c" class="final-score">Team C: 0</div>
            </div>
            <button id="restart-btn" class="btn">Play Again</button>
        </div>
    </div>

    <audio id="click-sound" src="https://www.soundjay.com/buttons/sounds/button-3.mp3" preload="auto"></audio>
    <audio id="correct-sound" src="https://www.soundjay.com/buttons/sounds/button-1.mp3" preload="auto"></audio>
    <audio id="wrong-sound" src="https://www.soundjay.com/buttons/sounds/button-10.mp3" preload="auto"></audio>
    <audio id="timer-tick-sound" src="https://www.soundjay.com/clock/sounds/clock-ticking-2.mp3" loop preload="auto"></audio>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            
            // --- QUESTIONS DATABASE ---
            const allQuestions = [
                { question: "What comes next: 3, 9, 27, 81, ?", answer: "243" },
                { question: "Find the missing number: 1, 4, 9, 16, ?, 36", answer: "25" },
                { question: "If TWO + TWO = FOUR, what number does FOUR represent?", answer: "A common answer is 8794 based on a simple cipher, but many interpretations exist." },
                { question: "A clock shows 12:50. What is the angle between the hour and minute hand?", answer: "There are two angles: the smaller is 85¬∞, the larger reflex angle is 275¬∞" },
                { question: "You're in a room with 3 switches for a bulb in another room you can only enter once. How do you find the right switch?", answer: "Flip switch 1 on for a minute, then off. Flip switch 2 on. Enter the room. If light is on, it's switch 2. If off but bulb is warm, it's switch 1. If off and cold, it's switch 3." },
                { question: "I have three digits. All are odd. Their sum is 15. I am greater than 500. What number could I be?", answer: "Examples: 753, 951, 591, etc." },
                { question: "If ALLIGATOR is coded as BMMJHBUPS, what is CROCODILE?", answer: "DSPDPEJMF (Each letter is shifted forward by its position in the word)" },
                { question: "Which number when squared gives 12321?", answer: "111" },
                { question: "In a certain language, TREE is coded as UVGG. How is LEAF coded?", answer: "NGCF (Each letter is shifted forward by one)" },
                { question: "How many total squares are there in a standard 4x4 grid?", answer: "30 (16 1x1, 9 2x2, 4 3x3, 1 4x4)" },
                { question: "If 3x ‚Äì 7 = 2x + 8, what is x?", answer: "x = 15" },
                { question: "A puzzle box has 5 buttons, only one opens it. If you press 2 wrong buttons, it locks forever. What's the best strategy?", answer: "Press any one button. If it doesn't open, press any other button. Your chance of opening it is 2 out of 5 (40%)." },
                { question: "4 people build 4 walls in 4 days. How long for 8 people to build 8 walls?", answer: "4 days (Each person builds 1 wall in 4 days. With 8 people, they can still each build their wall in 4 days)." },
                { question: "A cube has a surface area of 150 cm¬≤. What is the length of one edge?", answer: "5 cm (150 / 6 sides = 25 cm¬≤ per side. ‚àö25 = 5 cm)." },
                { question: "What is the 12th term in the Fibonacci sequence (starting 1, 1...)?", answer: "144" },
                { question: "A palindrome number multiplied by 11 gives 5335. What was the number?", answer: "485 (5335 / 11 = 485)" },
                { question: "If x¬≤ + x = 132, what is the positive value of x?", answer: "x = 11 (11¬≤ + 11 = 121 + 11 = 132)" },
                { question: "Divide Rs. 750 among A, B, and C in the ratio 2:3:5. How much does B get?", answer: "Rs. 225 (Total parts = 10. One part = 75. B gets 3 parts = 3 * 75)" },
                { question: "What is the LCM (Least Common Multiple) of 3x¬≤, 6xy, and 9x¬≥y¬≤?", answer: "18x¬≥y¬≤" },
                { question: "Factorize: x¬≥ + 27", answer: "(x + 3)(x¬≤ - 3x + 9)" },
                { question: "If a¬≤ + b¬≤ = 100 and ab = 30, find (a + b)¬≤.", answer: "160 (Since (a+b)¬≤ = a¬≤ + b¬≤ + 2ab = 100 + 2*30)" },
                { question: "The average of 10 numbers is 32. Two of the numbers are 20 and 24. What's the average of the remaining 8?", answer: "34 (Total sum = 320. Sum of remaining = 320 - 44 = 276. Average = 276 / 8)" },
                { question: "Simplify: (3x¬≤ - 12x) / (3x)", answer: "x - 4" },
                { question: "What is the cube root of 3375?", answer: "15" },
                { question: "If sin(A) = 3/5 and A is an acute angle, find cos(A).", answer: "4/5 (Using sin¬≤A + cos¬≤A = 1, in a 3-4-5 right triangle)" },
                { question: "A train travels 240 km in 3 hours. How long will it take to travel 560 km at the same speed?", answer: "7 hours (Speed = 80 km/h. Time = 560 / 80)" },
                { question: "A rectangle has a perimeter of 60 cm and a length of 18 cm. What is its area?", answer: "216 cm¬≤ (2*18 + 2*width = 60 -> width = 12 cm. Area = 18 * 12)" },
                { question: "Solve for x in 2x¬≤ + 7x + 3 = 0.", answer: "x = -0.5 and x = -3" },
                { question: "Simplify: (2x¬≤ + 3x - 2) / (x + 2)", answer: "2x - 1 (By factoring the numerator to (2x-1)(x+2))" },
                { question: "What is the derivative of x¬≤ + 3x + 7 with respect to x?", answer: "2x + 3" },
                { question: "A number increases by 25%, then the new number decreases by 20%. What is the net percent change?", answer: "0% (No change. e.g., 100 -> 125 -> 100)" },
                { question: "Convert 25¬∞ Celsius to Fahrenheit.", answer: "77¬∞F (F = C * 9/5 + 32)" },
                { question: "How many neutrons are in a standard atom of Oxygen-16?", answer: "8 (16 [mass number] - 8 [protons] = 8)" },
                { question: "Which human organ is primarily responsible for maintaining balance?", answer: "The inner ear" },
                { question: "Which organ produces bile for digestion?", answer: "The liver" },
                { question: "How does your weight on the Moon compare to your weight on Earth?", answer: "It's about 1/6th of your Earth weight." },
                { question: "Which gas do plants release during photosynthesis?", answer: "Oxygen" },
                { question: "Which subatomic particle has no electric charge?", answer: "Neutron" },
                { question: "What is the main function of white blood cells?", answer: "To fight infection and disease" },
                { question: "Which vitamin is essential for blood clotting?", answer: "Vitamin K" },
                { question: "What is the primary growth hormone in humans?", answer: "Human Growth Hormone (HGH), or Somatotropin" },
                { question: "How many bones are in a typical adult human body?", answer: "206" },
                { question: "What device measures electric current?", answer: "An ammeter" },
                { question: "What causes the cycle of day and night on Earth?", answer: "The Earth's rotation on its axis" },
                { question: "Why does a magnetic compass needle point North?", answer: "It aligns with the Earth's magnetic field lines." },
                { question: "Which part of the eye controls the size of the pupil?", answer: "The iris" },
                { question: "Who is credited with developing the theory of general relativity?", answer: "Albert Einstein" },
                { question: "In the visible light spectrum, which color has the shortest wavelength?", answer: "Violet" },
                { question: "What type of lens is used in glasses to correct short-sightedness (myopia)?", answer: "A concave lens" },
                { question: "Into how many colors does a prism split white light?", answer: "Seven (Red, Orange, Yellow, Green, Blue, Indigo, Violet)" },
                { question: "What is the chemical symbol for gold?", answer: "Au (from the Latin word 'aurum')" },
                { question: "Who is primarily credited with creating the C programming language?", answer: "Dennis Ritchie" },
                { question: "In C programming, what is the purpose of the `int main()` function?", answer: "It's the mandatory starting point for the execution of the program." },
                { question: "Which standard library function is used to print output to the console in C?", answer: "`printf()`" },
                { question: "How do you write a single-line comment in C?", answer: "Using two forward slashes, like this: `// This is a comment`" },
                { question: "In C, what is the output of: `int a = 10; printf(\"%d\", ++a);`?", answer: "11 (The value of 'a' is incremented *before* it's printed)" },
                { question: "What is the typical size of an `int` data type in a 64-bit C compiler?", answer: "4 bytes (32 bits), though this can be system-dependent." },
                { question: "What is the primary purpose of the `scanf()` function in C?", answer: "To read formatted input from the standard input (usually the keyboard)." },
                { question: "Which keyword is used to declare a variable that cannot be modified?", answer: "`const`" },
                { question: "What does the `break` statement do inside a loop in C?", answer: "It immediately terminates the current loop and execution continues at the next statement after the loop." },
                { question: "Who was the first king to unify Nepal?", answer: "Prithvi Narayan Shah" },
                { question: "In which year (A.D.) was Nepal officially declared a republic?", answer: "2008 A.D." },
                { question: "How many articles are in the 2015 Constitution of Nepal (Nepal ko Sambidhan 2072)?", answer: "308 articles" },
                { question: "What is the officially recognized height of Mt. Everest after the 2020 survey?", answer: "8,848.86 meters (29,031.7 feet)" },
                { question: "Name a famous UNESCO World Heritage Site located in the Kathmandu Valley.", answer: "Examples: Pashupatinath Temple, Swayambhunath Stupa, Boudhanath Stupa, Kathmandu Durbar Square." },
                { question: "Who was the first elected Prime Minister of Nepal?", answer: "Bishweshwar Prasad (B.P.) Koirala" },
                { question: "Which is the deepest lake in Nepal?", answer: "Shey Phoksundo Lake" },
                { question: "What is the name of the script used to write the Nepali language?", answer: "Devanagari script" },
                { question: "The Kali Gandaki Gorge in Nepal is the deepest in the world. Which two Himalayan peaks does it lie between?", answer: "Annapurna and Dhaulagiri" },
                { question: "Who was the first female president of Nepal?", answer: "Bidhya Devi Bhandari" },
                { question: "By area, which is the largest province of Nepal?", answer: "Karnali Province" },
                { question: "What is the national sport of Nepal as of 2017?", answer: "Volleyball" },
                { question: "A man is found murdered on a Sunday morning. The wife says she was reading. The butler says he was taking a shower. The chef says he was making breakfast. The gardener says he was planting seeds. Who did it?", answer: "The gardener. You can't plant seeds in the morning if they need sunlight to grow that has not yet risen fully. (This is a classic riddle with many variations and 'trick' answers)." },
                { question: "What comes next in the sequence: 10, 13, 16, 19, ...?", answer: "22, 25 (The pattern is to add 3 each time)." },
                { question: "What word in the English language is always spelled incorrectly?", answer: "Incorrectly" },
                { question: "I am heavy forwards, but backwards I am not. What am I?", answer: "A ton" },
                { question: "What has hands and a face, but can't hold anything or smile?", answer: "A clock" },
                { question: "If 6 cats can catch 6 rats in 6 minutes, how many cats are needed to catch 100 rats in 100 minutes?", answer: "6 cats (It takes one cat 6 minutes to catch one rat. That same cat can catch multiple rats given more time)." },
                { question: "What comes once in a minute, twice in a moment, but never in a thousand years?", answer: "The letter 'M'" },
                { question: "A man buys a stock for Rs. 1000 and sells it for Rs. 1200. He buys it back for Rs. 1300 and sells it for Rs. 1500. How much profit did he make?", answer: "Rs. 400 (He made Rs. 200 on each of the two separate transactions)." },
                { question: "I am an odd number. Take away a letter, and I become even. What number am I?", answer: "Seven (S-even)" },
                { question: "The more of this there is, the less you see. What is it?", answer: "Darkness" },
                { question: "What five-letter word becomes shorter when you add two letters to it?", answer: "Short (Short + er = Shorter)" },
                { question: "What is the next letter in this sequence: J, F, M, A, M, J, ...?", answer: "J (The sequence is the first letter of the months of the year: January, February...)" },
                { question: "Counting from 1 to 100, how many times does the digit '9' appear?", answer: "20 times (9, 19, 29, 39, 49, 59, 69, 79, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99)" },
                { question: "What three positive numbers give the same result when multiplied and added together?", answer: "1, 2, and 3 (1+2+3 = 6; 1*2*3 = 6)" },
                { question: "When you multiply me by any other number, the answer is always the same. What number am I?", answer: "Zero (0)" },
                { question: "What gets wetter as it dries?", answer: "A towel" },
                { question: "A man has 53 socks in his drawer: 21 black, 15 blue, and 17 red. The lights are out. How many socks must he take out to be 100% sure he has a matching pair?", answer: "4 socks (Worst case: he pulls one of each color (3 socks), the next one is guaranteed to match one of them)." },
                { question: "Which weighs more: a kilogram of feathers or a kilogram of gold?", answer: "Neither, they both weigh one kilogram." },
                { question: "How many seconds are in a day?", answer: "86,400 (60 seconds * 60 minutes * 24 hours)" },
                { question: "A car travels 120 km in 2 hours and returns the same distance in 3 hours. What is the average speed for the entire trip?", answer: "48 km/h (Total distance = 240 km. Total time = 5 hours. Average speed = 240/5)" },
                { question: "A boy is twice as old as his sister. His sister is 10. How old will the boy be when his sister is 15?", answer: "25 years old (The boy is currently 20. The age gap is 10 years.)" },
                { question: "If 5 workers can build a wall in 12 hours, how long would it take 10 workers?", answer: "6 hours (Double the workers, half the time)." },
                { question: "What is the sum of the first 50 positive integers (1 + 2 + ... + 50)?", answer: "1275 (Using the formula n(n+1)/2)" },
                { question: "How many diagonals does a regular hexagon have?", answer: "9" },
                { question: "What is the square root of 1024?", answer: "32" },
                { question: "At a party of 15 people, everyone shakes hands with everyone else exactly once. How many handshakes occur?", answer: "105 (Using the formula n(n-1)/2)" },
                { question: "What is the value of 0! (zero factorial)?", answer: "1" }
            ];

            // --- GAME STATE ---
            let gameState = {};

            // --- DOM ELEMENTS ---
            const welcomeScreen = document.getElementById('welcome-screen');
            const gameBoard = document.getElementById('game-board');
            const endScreen = document.getElementById('end-screen');
            const startGameBtn = document.getElementById('start-game-btn');
            const teamSelectionArea = document.getElementById('team-selection-area');
            const teamButtons = document.querySelectorAll('.team-btn');
            const scoreDisplays = {
                A: document.getElementById('score-val-a'),
                B: document.getElementById('score-val-b'),
                C: document.getElementById('score-val-c'),
            };
            const scoreBoxes = {
                A: document.getElementById('score-a'),
                B: document.getElementById('score-b'),
                C: document.getElementById('score-c'),
            }
            const gameStatusText = document.getElementById('game-status-text');
            const questionPicker = document.getElementById('question-picker');
            const questionArea = document.getElementById('question-area');
            const timerDisplay = document.getElementById('timer');
            const questionText = document.getElementById('question-text');
            const startTimerWrapper = document.getElementById('start-timer-wrapper');
            const answerActionsWrapper = document.getElementById('answer-actions-wrapper');
            const startTimerBtn = document.getElementById('start-timer-btn');
            const correctBtn = document.getElementById('correct-btn');
            const wrongBtn = document.getElementById('wrong-btn');
            const answerModal = document.getElementById('answer-modal');
            const answerText = document.getElementById('answer-text');
            const winnerText = document.getElementById('winner-text');
            const finalScoreDisplays = {
                A: document.getElementById('final-score-a'),
                B: document.getElementById('final-score-b'),
                C: document.getElementById('final-score-c'),
            }
            const restartBtn = document.getElementById('restart-btn');

            // --- AUDIO ELEMENTS ---
            const sounds = {
                click: document.getElementById('click-sound'),
                correct: document.getElementById('correct-sound'),
                wrong: document.getElementById('wrong-sound'),
                timer: document.getElementById('timer-tick-sound'),
            };

            // --- GAME LOGIC ---

            function playSound(sound) {
                sounds[sound].currentTime = 0;
                sounds[sound].play();
            }

            function stopSound(sound) {
                sounds[sound].pause();
                sounds[sound].currentTime = 0;
            }

            function shuffleArray(array) {
                for (let i = array.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [array[i], array[j]] = [array[j], array[i]];
                }
            }

            function resetGame() {
                gameState = {
                    scores: { A: 0, B: 0, C: 0 },
                    currentTeam: null,
                    questions: [],
                    answeredCount: 0,
                    timerInterval: null,
                    teams: ['A', 'B', 'C'],
                    currentTeamIndex: -1,
                    isTeamSelectionPhase: true,
                };
                
                shuffleArray(allQuestions);
                gameState.questions = [...allQuestions];

                // Reset UI
                welcomeScreen.classList.remove('hidden');
                gameBoard.classList.add('hidden');
                endScreen.classList.add('hidden');
                teamSelectionArea.classList.remove('hidden');

                teamButtons.forEach(btn => btn.classList.remove('active'));
                updateScoresUI();
                createQuestionPicker();
                resetQuestionArea();
                gameStatusText.textContent = "Select a team to start playing.";
                Object.values(scoreBoxes).forEach(box => box.classList.remove('highlight-turn'));
            }

            function createQuestionPicker() {
                questionPicker.innerHTML = '';
                for (let i = 0; i < 100; i++) {
                    const box = document.createElement('div');
                    box.className = 'question-box';
                    box.textContent = i + 1;
                    box.dataset.index = i;
                    box.addEventListener('click', () => pickQuestion(i));
                    questionPicker.appendChild(box);
                }
                questionPicker.classList.add('disabled');
            }

            function updateScoresUI() {
                for (const team in gameState.scores) {
                    scoreDisplays[team].textContent = gameState.scores[team];
                }
            }

            function nextTurn() {
                gameState.currentTeamIndex = (gameState.currentTeamIndex + 1) % gameState.teams.length;
                gameState.currentTeam = gameState.teams[gameState.currentTeamIndex];

                // Update UI for the new turn
                gameStatusText.textContent = `Team ${gameState.currentTeam}, pick a question!`;
                Object.values(scoreBoxes).forEach(box => box.classList.remove('highlight-turn'));
                scoreBoxes[gameState.currentTeam].classList.add('highlight-turn');
                
                questionPicker.classList.remove('disabled');
                resetQuestionArea();
            }

            function pickQuestion(index) {
                playSound('click');
                gameState.activeQuestion = gameState.questions[index];
                
                // Visually mark the question as used
                const questionBox = questionPicker.querySelector(`[data-index='${index}']`);
                questionBox.classList.add('used');

                // Prepare the question area
                questionPicker.classList.add('disabled'); // Disable picker during question
                questionText.textContent = "Get Ready...";
                gameStatusText.textContent = `Question ${index + 1}`;
                questionArea.classList.remove('hidden');
                startTimerWrapper.classList.remove('hidden');
                answerActionsWrapper.classList.add('hidden');
            }
            
            function startTimer() {
                playSound('timer');
                questionText.textContent = gameState.activeQuestion.question;
                startTimerWrapper.classList.add('hidden');
                answerActionsWrapper.classList.remove('hidden');
                
                let timeLeft = 30;
                timerDisplay.textContent = timeLeft;
                timerDisplay.classList.remove('low-time');
                
                gameState.timerInterval = setInterval(() => {
                    timeLeft--;
                    timerDisplay.textContent = timeLeft;
                    if (timeLeft <= 5) {
                        timerDisplay.classList.add('low-time');
                    }
                    if (timeLeft <= 0) {
                        handleAnswer(false, true); // Automatically wrong if time runs out
                    }
                }, 1000);
            }

            function handleAnswer(isCorrect, isTimeUp = false) {
                clearInterval(gameState.timerInterval);
                stopSound('timer');
                
                if (isCorrect) {
                    playSound('correct');
                    gameState.scores[gameState.currentTeam]++;
                    updateScoresUI();
                } else {
                    playSound('wrong');
                }
                
                gameState.answeredCount++;
                showAnswerModal(isTimeUp);
            }

            function showAnswerModal(isTimeUp) {
                let message = gameState.activeQuestion.answer;
                if (isTimeUp) {
                    message = `TIME'S UP! The answer was: ${message}`;
                }
                answerText.textContent = message;
                answerModal.classList.add('visible');

                setTimeout(() => {
                    answerModal.classList.remove('visible');
                    if (gameState.answeredCount >= 100) {
                        endGame();
                    } else {
                        nextTurn();
                    }
                }, 4000); // Show answer for 4 seconds
            }

            function resetQuestionArea() {
                questionArea.classList.add('hidden');
                timerDisplay.textContent = '30';
                timerDisplay.classList.remove('low-time');
            }

            function endGame() {
                // Determine winner
                const finalScores = gameState.scores;
                const winner = Object.keys(finalScores).reduce((a, b) => finalScores[a] > finalScores[b] ? a : b);

                winnerText.textContent = `Congratulations Team ${winner}!`;

                // Update final score display
                for (const team in finalScores) {
                    finalScoreDisplays[team].textContent = `Team ${team}: ${finalScores[team]}`;
                }
                
                gameBoard.classList.add('hidden');
                endScreen.classList.remove('hidden');
            }

            // --- EVENT LISTENERS ---
            startGameBtn.addEventListener('click', () => {
                playSound('click');
                welcomeScreen.classList.add('hidden');
                gameBoard.classList.remove('hidden');
            });

            teamButtons.forEach(btn => {
                btn.addEventListener('click', () => {
                    if (!gameState.isTeamSelectionPhase) return;
                    playSound('click');
                    
                    const team = btn.dataset.team;
                    if (!gameState.teams.includes(team)) {
                        gameState.teams.push(team);
                    }
                    btn.classList.toggle('active');

                    // Check if at least one team is selected to start
                    const anyTeamSelected = Array.from(teamButtons).some(b => b.classList.contains('active'));
                    if(anyTeamSelected && gameState.isTeamSelectionPhase) {
                        gameState.isTeamSelectionPhase = false;
                        teamSelectionArea.classList.add('hidden');
                        nextTurn(); // Start the first turn
                    }
                });
            });

            startTimerBtn.addEventListener('click', startTimer);
            correctBtn.addEventListener('click', () => handleAnswer(true));
            wrongBtn.addEventListener('click', () => handleAnswer(false));
            restartBtn.addEventListener('click', () => {
                playSound('click');
                resetGame();
            });

            // --- INITIALIZE ---
            resetGame();
        });
    </script>
</body>
</html>
